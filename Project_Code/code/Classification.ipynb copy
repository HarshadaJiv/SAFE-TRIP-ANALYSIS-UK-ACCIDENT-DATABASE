{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 78,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Importing all the libraries\n",
    "\n",
    "import pandas as pd\n",
    "\n",
    "import numpy as np\n",
    "\n",
    "import sklearn\n",
    "\n",
    "from sklearn.metrics import accuracy_score\n",
    "\n",
    "from sklearn.metrics import f1_score\n",
    "\n",
    "from sklearn.metrics import confusion_matrix\n",
    "\n",
    "from sklearn.metrics import classification_report\n",
    "\n",
    "from sklearn import model_selection\n",
    "\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "from sklearn.model_selection import train_test_split\n",
    "\n",
    "from sklearn.model_selection import GridSearchCV\n",
    "\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "\n",
    "from sklearn.pipeline import Pipeline\n",
    "\n",
    "from sklearn.preprocessing import PolynomialFeatures\n",
    "\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "\n",
    "from sklearn.preprocessing import MinMaxScaler\n",
    "\n",
    "from sklearn.svm import LinearSVC\n",
    "\n",
    "from sklearn import svm\n",
    "\n",
    "from xgboost import XGBClassifier\n",
    "\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3063: DtypeWarning: Columns (0) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  interactivity=interactivity, compiler=compiler, result=result)\n"
     ]
    }
   ],
   "source": [
    "#Loading the preprocessed data for Casualities\n",
    "\n",
    "df = pd.read_csv(\"../data/data.csv\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# df = df.drop(columns = 'Casualty_IMD_Decile')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Accident_Index</th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Casualty_Severity</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2019010128300</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>58</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2019010152270</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>24</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2019010155191</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2019010155192</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>68</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2019010155194</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>47</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455156</th>\n",
       "      <td>2017984121217</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455157</th>\n",
       "      <td>2017984121717</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>19</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455158</th>\n",
       "      <td>2017984122317</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455159</th>\n",
       "      <td>2017984122617</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455160</th>\n",
       "      <td>2017984122617</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>455161 rows Ã— 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Accident_Index  Vehicle_Reference  Casualty_Reference  Casualty_Class  \\\n",
       "0       2019010128300                  1                   1               1   \n",
       "1       2019010152270                  1                   1               1   \n",
       "2       2019010155191                  2                   1               2   \n",
       "3       2019010155192                  1                   1               3   \n",
       "4       2019010155194                  1                   1               1   \n",
       "...               ...                ...                 ...             ...   \n",
       "455156  2017984121217                  1                   1               3   \n",
       "455157  2017984121717                  1                   1               2   \n",
       "455158  2017984122317                  1                   1               1   \n",
       "455159  2017984122617                  1                   1               1   \n",
       "455160  2017984122617                  2                   2               1   \n",
       "\n",
       "        Sex_of_Casualty  Age_of_Casualty  Age_Band_of_Casualty  \\\n",
       "0                     1               58                     9   \n",
       "1                     2               24                     5   \n",
       "2                     2               21                     5   \n",
       "3                     1               68                    10   \n",
       "4                     2               47                     8   \n",
       "...                 ...              ...                   ...   \n",
       "455156                2               49                     8   \n",
       "455157                1               22                     5   \n",
       "455158                1               25                     5   \n",
       "455159                1               49                     8   \n",
       "455160                1               50                     8   \n",
       "\n",
       "        Casualty_Severity  Pedestrian_Location  Pedestrian_Movement  \\\n",
       "0                       3                    0                    0   \n",
       "1                       3                    0                    0   \n",
       "2                       3                    0                    0   \n",
       "3                       2                    5                    4   \n",
       "4                       3                    0                    0   \n",
       "...                   ...                  ...                  ...   \n",
       "455156                  3                    9                    6   \n",
       "455157                  3                    0                    0   \n",
       "455158                  3                    0                    0   \n",
       "455159                  3                    0                    0   \n",
       "455160                  2                    0                    0   \n",
       "\n",
       "        Car_Passenger  Bus_or_Coach_Passenger  \\\n",
       "0                   0                       0   \n",
       "1                   0                       0   \n",
       "2                   0                       0   \n",
       "3                   0                       0   \n",
       "4                   0                       0   \n",
       "...               ...                     ...   \n",
       "455156              0                       0   \n",
       "455157              1                       0   \n",
       "455158              0                       0   \n",
       "455159              0                       0   \n",
       "455160              0                       0   \n",
       "\n",
       "        Pedestrian_Road_Maintenance_Worker  Casualty_Type  \\\n",
       "0                                        0              9   \n",
       "1                                        0              9   \n",
       "2                                        0              1   \n",
       "3                                        0              0   \n",
       "4                                        0              9   \n",
       "...                                    ...            ...   \n",
       "455156                                   0              0   \n",
       "455157                                   0             19   \n",
       "455158                                   0              4   \n",
       "455159                                   0              9   \n",
       "455160                                   0              9   \n",
       "\n",
       "        Casualty_Home_Area_Type  \n",
       "0                             1  \n",
       "1                             1  \n",
       "2                             1  \n",
       "3                             1  \n",
       "4                             1  \n",
       "...                         ...  \n",
       "455156                        3  \n",
       "455157                        1  \n",
       "455158                        1  \n",
       "455159                        3  \n",
       "455160                        2  \n",
       "\n",
       "[455161 rows x 15 columns]"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df #checking what this dataframe df looks like"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Casualty_Severity</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "      <td>455161.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>1.480160</td>\n",
       "      <td>1.390326</td>\n",
       "      <td>1.489420</td>\n",
       "      <td>1.404633</td>\n",
       "      <td>37.523696</td>\n",
       "      <td>6.454070</td>\n",
       "      <td>2.817838</td>\n",
       "      <td>0.752703</td>\n",
       "      <td>0.592487</td>\n",
       "      <td>0.246352</td>\n",
       "      <td>0.070470</td>\n",
       "      <td>0.063617</td>\n",
       "      <td>7.232718</td>\n",
       "      <td>1.258667</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>1.606569</td>\n",
       "      <td>2.369551</td>\n",
       "      <td>0.727948</td>\n",
       "      <td>0.490821</td>\n",
       "      <td>19.065580</td>\n",
       "      <td>2.246024</td>\n",
       "      <td>0.414299</td>\n",
       "      <td>2.111084</td>\n",
       "      <td>1.909064</td>\n",
       "      <td>0.566235</td>\n",
       "      <td>0.504128</td>\n",
       "      <td>0.350159</td>\n",
       "      <td>8.175433</td>\n",
       "      <td>0.613666</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>23.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>34.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>51.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>999.000000</td>\n",
       "      <td>991.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>102.000000</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>98.000000</td>\n",
       "      <td>3.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Vehicle_Reference  Casualty_Reference  Casualty_Class  Sex_of_Casualty  \\\n",
       "count      455161.000000       455161.000000   455161.000000    455161.000000   \n",
       "mean            1.480160            1.390326        1.489420         1.404633   \n",
       "std             1.606569            2.369551        0.727948         0.490821   \n",
       "min             1.000000            1.000000        1.000000         1.000000   \n",
       "25%             1.000000            1.000000        1.000000         1.000000   \n",
       "50%             1.000000            1.000000        1.000000         1.000000   \n",
       "75%             2.000000            1.000000        2.000000         2.000000   \n",
       "max           999.000000          991.000000        3.000000         2.000000   \n",
       "\n",
       "       Age_of_Casualty  Age_Band_of_Casualty  Casualty_Severity  \\\n",
       "count    455161.000000         455161.000000      455161.000000   \n",
       "mean         37.523696              6.454070           2.817838   \n",
       "std          19.065580              2.246024           0.414299   \n",
       "min           0.000000              1.000000           1.000000   \n",
       "25%          23.000000              5.000000           3.000000   \n",
       "50%          34.000000              6.000000           3.000000   \n",
       "75%          51.000000              8.000000           3.000000   \n",
       "max         102.000000             11.000000           3.000000   \n",
       "\n",
       "       Pedestrian_Location  Pedestrian_Movement  Car_Passenger  \\\n",
       "count        455161.000000        455161.000000  455161.000000   \n",
       "mean              0.752703             0.592487       0.246352   \n",
       "std               2.111084             1.909064       0.566235   \n",
       "min               0.000000             0.000000       0.000000   \n",
       "25%               0.000000             0.000000       0.000000   \n",
       "50%               0.000000             0.000000       0.000000   \n",
       "75%               0.000000             0.000000       0.000000   \n",
       "max              10.000000             9.000000       2.000000   \n",
       "\n",
       "       Bus_or_Coach_Passenger  Pedestrian_Road_Maintenance_Worker  \\\n",
       "count           455161.000000                       455161.000000   \n",
       "mean                 0.070470                            0.063617   \n",
       "std                  0.504128                            0.350159   \n",
       "min                  0.000000                            0.000000   \n",
       "25%                  0.000000                            0.000000   \n",
       "50%                  0.000000                            0.000000   \n",
       "75%                  0.000000                            0.000000   \n",
       "max                  4.000000                            2.000000   \n",
       "\n",
       "       Casualty_Type  Casualty_Home_Area_Type  \n",
       "count  455161.000000            455161.000000  \n",
       "mean        7.232718                 1.258667  \n",
       "std         8.175433                 0.613666  \n",
       "min         0.000000                 1.000000  \n",
       "25%         2.000000                 1.000000  \n",
       "50%         9.000000                 1.000000  \n",
       "75%         9.000000                 1.000000  \n",
       "max        98.000000                 3.000000  "
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe() #Studying about the df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 455161 entries, 0 to 455160\n",
      "Data columns (total 15 columns):\n",
      " #   Column                              Non-Null Count   Dtype \n",
      "---  ------                              --------------   ----- \n",
      " 0   Accident_Index                      455161 non-null  object\n",
      " 1   Vehicle_Reference                   455161 non-null  int64 \n",
      " 2   Casualty_Reference                  455161 non-null  int64 \n",
      " 3   Casualty_Class                      455161 non-null  int64 \n",
      " 4   Sex_of_Casualty                     455161 non-null  int64 \n",
      " 5   Age_of_Casualty                     455161 non-null  int64 \n",
      " 6   Age_Band_of_Casualty                455161 non-null  int64 \n",
      " 7   Casualty_Severity                   455161 non-null  int64 \n",
      " 8   Pedestrian_Location                 455161 non-null  int64 \n",
      " 9   Pedestrian_Movement                 455161 non-null  int64 \n",
      " 10  Car_Passenger                       455161 non-null  int64 \n",
      " 11  Bus_or_Coach_Passenger              455161 non-null  int64 \n",
      " 12  Pedestrian_Road_Maintenance_Worker  455161 non-null  int64 \n",
      " 13  Casualty_Type                       455161 non-null  int64 \n",
      " 14  Casualty_Home_Area_Type             455161 non-null  int64 \n",
      "dtypes: int64(14), object(1)\n",
      "memory usage: 52.1+ MB\n"
     ]
    }
   ],
   "source": [
    "df.info() #Studying about the df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "X = df.loc[:, df.columns != 'Casualty_Severity'] \n",
    "#Casualty_Severity is the target column. We don't want to include this in the training data\n",
    "\n",
    "X = X.loc[:, X.columns != 'Accident_Index']\n",
    "#Accident_Index is key of the accident dataset. This is not a valid feature in training/testing data.\n",
    "\n",
    "X = X.loc[:, X.columns != 'Casualty_Reference']\n",
    "#Casualty_Reference is key of the casuality dataset. This is not a valid feature in training/testing data.\n",
    "\n",
    "\n",
    "y = df['Casualty_Severity']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>58</td>\n",
       "      <td>9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>24</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>68</td>\n",
       "      <td>10</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>47</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455156</th>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455157</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>19</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455158</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455159</th>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455160</th>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>455161 rows Ã— 12 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        Vehicle_Reference  Casualty_Class  Sex_of_Casualty  Age_of_Casualty  \\\n",
       "0                       1               1                1               58   \n",
       "1                       1               1                2               24   \n",
       "2                       2               2                2               21   \n",
       "3                       1               3                1               68   \n",
       "4                       1               1                2               47   \n",
       "...                   ...             ...              ...              ...   \n",
       "455156                  1               3                2               49   \n",
       "455157                  1               2                1               22   \n",
       "455158                  1               1                1               25   \n",
       "455159                  1               1                1               49   \n",
       "455160                  2               1                1               50   \n",
       "\n",
       "        Age_Band_of_Casualty  Pedestrian_Location  Pedestrian_Movement  \\\n",
       "0                          9                    0                    0   \n",
       "1                          5                    0                    0   \n",
       "2                          5                    0                    0   \n",
       "3                         10                    5                    4   \n",
       "4                          8                    0                    0   \n",
       "...                      ...                  ...                  ...   \n",
       "455156                     8                    9                    6   \n",
       "455157                     5                    0                    0   \n",
       "455158                     5                    0                    0   \n",
       "455159                     8                    0                    0   \n",
       "455160                     8                    0                    0   \n",
       "\n",
       "        Car_Passenger  Bus_or_Coach_Passenger  \\\n",
       "0                   0                       0   \n",
       "1                   0                       0   \n",
       "2                   0                       0   \n",
       "3                   0                       0   \n",
       "4                   0                       0   \n",
       "...               ...                     ...   \n",
       "455156              0                       0   \n",
       "455157              1                       0   \n",
       "455158              0                       0   \n",
       "455159              0                       0   \n",
       "455160              0                       0   \n",
       "\n",
       "        Pedestrian_Road_Maintenance_Worker  Casualty_Type  \\\n",
       "0                                        0              9   \n",
       "1                                        0              9   \n",
       "2                                        0              1   \n",
       "3                                        0              0   \n",
       "4                                        0              9   \n",
       "...                                    ...            ...   \n",
       "455156                                   0              0   \n",
       "455157                                   0             19   \n",
       "455158                                   0              4   \n",
       "455159                                   0              9   \n",
       "455160                                   0              9   \n",
       "\n",
       "        Casualty_Home_Area_Type  \n",
       "0                             1  \n",
       "1                             1  \n",
       "2                             1  \n",
       "3                             1  \n",
       "4                             1  \n",
       "...                         ...  \n",
       "455156                        3  \n",
       "455157                        1  \n",
       "455158                        1  \n",
       "455159                        3  \n",
       "455160                        2  \n",
       "\n",
       "[455161 rows x 12 columns]"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X #X dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         3\n",
       "1         3\n",
       "2         3\n",
       "3         2\n",
       "4         3\n",
       "         ..\n",
       "455156    3\n",
       "455157    3\n",
       "455158    3\n",
       "455159    3\n",
       "455160    2\n",
       "Name: Casualty_Severity, Length: 455161, dtype: int64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y #Target column"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n",
    "\n",
    "# Splitting the dataset X and y into X_train, X_tests, and y_train, y_tests correspondingly.\n",
    "# Split ratio of 80:20% is used and random_state is used to produce the same datapoints every time (reproducible)."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Model 1: logistic regression - accuracy 82%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# grid={\"C\":np.logspace(-3,3,7), \"penalty\":[\"l1\",\"l2\"]}# l1 lasso l2 ridge\n",
    "\n",
    "# #Defining the LogisticRegression model. fit_intercept is the bias added the decision function.\n",
    "# model = GridSearchCV(LogisticRegression(),grid,cv=10)\n",
    "\n",
    "# # Fitting the training (X and y) data into the model. The model learns the data now.\n",
    "# model.fit(X_train,y_train)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "LogisticRegression(C=1, class_weight=None, dual=False, fit_intercept=True,\n",
       "                   intercept_scaling=0.1, l1_ratio=None, max_iter=100,\n",
       "                   multi_class='auto', n_jobs=None, penalty='l2',\n",
       "                   random_state=None, solver='lbfgs', tol=0.0001, verbose=0,\n",
       "                   warm_start=False)"
      ]
     },
     "execution_count": 30,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "model = LogisticRegression(C=1, fit_intercept=True, intercept_scaling=1)\n",
    "model.fit(X_train, y_train)\n",
    "\n",
    "#When C = 0.1, accuracy 82.8%\n",
    "#When C = 0.01, accuracy 82.8%\n",
    "#When C = 1, accuracy 82.8%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Now that the model learnt the data, we will try to predict y_pred for X_test\n",
    "\n",
    "y_pred = model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Minimum of the predictions is 2\n",
      "Maximum of the predictions is 3\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "array([3, 3, 3, ..., 3, 3, 3])"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# This is how the predicted data looks like\\\n",
    "\n",
    "# print(\"tuned hpyerparameters :(best parameters) \",model.best_params_)\n",
    "# print(\"accuracy :\",model.best_score_)\n",
    "\n",
    "print('Minimum of the predictions is ' + str(np.amin(y_pred)))\n",
    "print('Maximum of the predictions is ' + str(np.amax(y_pred)))\n",
    "\n",
    "y_pred"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8282051563718652"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# We got 82.8% accuracy of the predictions\n",
    "\n",
    "accuracy_score(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(91033,)"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "y_pred.shape\n",
    "\n",
    "# y_test.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.3022386120935548"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Macro F1 score\n",
    "\n",
    "f1_score(y_test, y_pred, average='macro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.8282051563718651"
      ]
     },
     "execution_count": 38,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Micro F1 score\n",
    "\n",
    "f1_score(y_test, y_pred, average='micro')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.7504989855579528"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Weighted F1 score\n",
    "\n",
    "f1_score(y_test, y_pred, average='weighted')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.00000000e+00, 6.85166153e-04, 9.06030670e-01])"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Average F1 score\n",
    "\n",
    "f1_score(y_test, y_pred, average=None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Logistic Regression Accuracy: 82.82051563718652\n",
      "Logistic Regression Classification report:\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           1       0.00      0.00      0.00      1055\n",
      "           2       0.42      0.00      0.00     14583\n",
      "           3       0.83      1.00      0.91     75395\n",
      "\n",
      "    accuracy                           0.83     91033\n",
      "   macro avg       0.41      0.33      0.30     91033\n",
      "weighted avg       0.75      0.83      0.75     91033\n",
      "\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    }
   ],
   "source": [
    "print('\\nLogistic Regression Accuracy: ' + str(accuracy_score(y_test, y_pred)*100))\n",
    "print('Logistic Regression Classification report:\\n', classification_report(y_test, y_pred))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[    0,     1,  1054],\n",
       "       [    0,     5, 14578],\n",
       "       [    0,     6, 75389]])"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "confusion_matrix(y_test, y_pred)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Model 2: K-Fold Cross Validation"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/model_selection/_split.py:296: FutureWarning: Setting a random_state has no effect since shuffle is False. This will raise an error in 0.24. You should leave random_state to its default (None), or set shuffle=True.\n",
      "  FutureWarning\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Accuracy: 82.914% (1.257%)\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:940: ConvergenceWarning: lbfgs failed to converge (status=1):\n",
      "STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.\n",
      "\n",
      "Increase the number of iterations (max_iter) or scale the data as shown in:\n",
      "    https://scikit-learn.org/stable/modules/preprocessing.html\n",
      "Please also refer to the documentation for alternative solver options:\n",
      "    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression\n",
      "  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)\n"
     ]
    }
   ],
   "source": [
    "num_instances = len(X)\n",
    "seed = 7\n",
    "kfold = model_selection.KFold(n_splits=10, random_state=seed)\n",
    "model = LogisticRegression()\n",
    "results = model_selection.cross_val_score(model, X, y, cv=kfold)\n",
    "print(\"Accuracy: %.3f%% (%.3f%%)\" % (results.mean()*100.0, results.std()*100.0))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Model 3: Random Forests - accuracy 81.89%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [],
   "source": [
    "# random forest model creation\n",
    "model = RandomForestClassifier()\n",
    "model.fit(X_train,y_train)\n",
    "\n",
    "# predictions\n",
    "y_pred = model.predict(X_test)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "\n",
      "Random Forest Accuracy: 81.89447782672218\n",
      "Random Forest Classification report:\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           1       0.07      0.01      0.01      1055\n",
      "           2       0.34      0.07      0.11     14583\n",
      "           3       0.83      0.98      0.90     75395\n",
      "\n",
      "    accuracy                           0.82     91033\n",
      "   macro avg       0.42      0.35      0.34     91033\n",
      "weighted avg       0.75      0.82      0.76     91033\n",
      "\n"
     ]
    }
   ],
   "source": [
    "print('\\nRandom Forest Accuracy: ' + str(accuracy_score(y_test, model)*100))\n",
    "print('Random Forest Classification report:\\n', classification_report(y_test, model))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Method 4: Polynomial Kernel SVM, Accuracy = 82.82"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/svm/_base.py:947: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  \"the number of iterations.\", ConvergenceWarning)\n"
     ]
    },
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Polynomial Regression Accuracy: 82.82161413992728\n",
      "Polynomial Regression Classification report:\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           1       0.00      0.00      0.00      1055\n",
      "           2       0.00      0.00      0.00     14583\n",
      "           3       0.83      1.00      0.91     75395\n",
      "\n",
      "    accuracy                           0.83     91033\n",
      "   macro avg       0.28      0.33      0.30     91033\n",
      "weighted avg       0.69      0.83      0.75     91033\n",
      "\n",
      "Confusion Matrix :\n",
      "[[    0     0  1055]\n",
      " [    0     0 14583]\n",
      " [    0     0 75395]]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    }
   ],
   "source": [
    "model = Pipeline([\n",
    "        (\"poly_features\", PolynomialFeatures(degree=3)),\n",
    "        (\"scaler\", MinMaxScaler()),\n",
    "        (\"svm_clf\", LinearSVC(C=1, loss=\"hinge\", random_state=42))\n",
    "    ])\n",
    "\n",
    "\n",
    "# y_trainRaveled=y_train.ravel()\n",
    "model.fit(X_train, y_train)\n",
    "\n",
    "#y_test\n",
    "y_pred = model.predict(X_test)\n",
    "\n",
    "\n",
    "#Confusion Matrix\n",
    "print('Polynomial Regression Accuracy: ' + str(accuracy_score(y_test, y_pred)*100))\n",
    "print('Polynomial Regression Classification report:\\n', classification_report(y_test, y_pred))\n",
    "\n",
    "results = confusion_matrix(y_test, y_pred) \n",
    "\n",
    "print (\"Confusion Matrix :\")\n",
    "print(results) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Method 5: Using svm.SVC kernel='linear', accuracy = 82.82%"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Linear SVM Accuracy: 82.82161413992728\n",
      "Linear SVM Classification report:\n",
      "               precision    recall  f1-score   support\n",
      "\n",
      "           1       0.00      0.00      0.00      1055\n",
      "           2       0.00      0.00      0.00     14583\n",
      "           3       0.83      1.00      0.91     75395\n",
      "\n",
      "    accuracy                           0.83     91033\n",
      "   macro avg       0.28      0.33      0.30     91033\n",
      "weighted avg       0.69      0.83      0.75     91033\n",
      "\n",
      "Confusion Matrix :\n",
      "[[    0     0  1055]\n",
      " [    0     0 14583]\n",
      " [    0     0 75395]]\n"
     ]
    },
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/svm/_base.py:947: ConvergenceWarning: Liblinear failed to converge, increase the number of iterations.\n",
      "  \"the number of iterations.\", ConvergenceWarning)\n",
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/sklearn/metrics/_classification.py:1272: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n",
      "  _warn_prf(average, modifier, msg_start, len(result))\n"
     ]
    }
   ],
   "source": [
    "# 1. Create an svm Classifier\n",
    "model = svmClassifier2 = Pipeline([\n",
    "    (\"scaler\", StandardScaler()), (\"linear_svc\", LinearSVC(C=0.1, loss='hinge',random_state=42))\n",
    "                          ])\n",
    "\n",
    "#2. Train the model using the training sets - fit the model - with training data\n",
    "model.fit(X_train, y_train)\n",
    "\n",
    "#3. Predict the response for test dataset - predict using the trained model for test data\n",
    "y_pred = model.predict(X_test)\n",
    "\n",
    "print('Linear SVM Accuracy: ' + str(accuracy_score(y_test, y_pred)*100))\n",
    "print('Linear SVM Classification report:\\n', classification_report(y_test, y_pred))\n",
    "\n",
    "results = confusion_matrix(y_test, y_pred) \n",
    "\n",
    "print (\"Confusion Matrix :\")\n",
    "print(results) "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "References:\n",
    "    \n",
    "    'micro':\n",
    "Calculate metrics globally by counting the total true positives, false negatives and false positives.\n",
    "\n",
    "'macro':\n",
    "Calculate metrics for each label, and find their unweighted mean. This does not take label imbalance into account.\n",
    "\n",
    "'weighted':\n",
    "Calculate metrics for each label, and find their average weighted by support (the number of true instances for each label). This alters â€˜macroâ€™ to account for label imbalance; it can result in an F-score that is not between precision and recall.\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Accident_Index</th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Casualty_Severity</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2019010128300</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>58</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2019010152270</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>24</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2019010155191</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2019010155192</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>68</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2019010155194</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>47</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455156</th>\n",
       "      <td>2017984121217</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455157</th>\n",
       "      <td>2017984121717</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>19</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455158</th>\n",
       "      <td>2017984122317</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455159</th>\n",
       "      <td>2017984122617</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>455160</th>\n",
       "      <td>2017984122617</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>455161 rows Ã— 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Accident_Index  Vehicle_Reference  Casualty_Reference  Casualty_Class  \\\n",
       "0       2019010128300                  1                   1               1   \n",
       "1       2019010152270                  1                   1               1   \n",
       "2       2019010155191                  2                   1               2   \n",
       "3       2019010155192                  1                   1               3   \n",
       "4       2019010155194                  1                   1               1   \n",
       "...               ...                ...                 ...             ...   \n",
       "455156  2017984121217                  1                   1               3   \n",
       "455157  2017984121717                  1                   1               2   \n",
       "455158  2017984122317                  1                   1               1   \n",
       "455159  2017984122617                  1                   1               1   \n",
       "455160  2017984122617                  2                   2               1   \n",
       "\n",
       "        Sex_of_Casualty  Age_of_Casualty  Age_Band_of_Casualty  \\\n",
       "0                     1               58                     9   \n",
       "1                     2               24                     5   \n",
       "2                     2               21                     5   \n",
       "3                     1               68                    10   \n",
       "4                     2               47                     8   \n",
       "...                 ...              ...                   ...   \n",
       "455156                2               49                     8   \n",
       "455157                1               22                     5   \n",
       "455158                1               25                     5   \n",
       "455159                1               49                     8   \n",
       "455160                1               50                     8   \n",
       "\n",
       "        Casualty_Severity  Pedestrian_Location  Pedestrian_Movement  \\\n",
       "0                       3                    0                    0   \n",
       "1                       3                    0                    0   \n",
       "2                       3                    0                    0   \n",
       "3                       2                    5                    4   \n",
       "4                       3                    0                    0   \n",
       "...                   ...                  ...                  ...   \n",
       "455156                  3                    9                    6   \n",
       "455157                  3                    0                    0   \n",
       "455158                  3                    0                    0   \n",
       "455159                  3                    0                    0   \n",
       "455160                  2                    0                    0   \n",
       "\n",
       "        Car_Passenger  Bus_or_Coach_Passenger  \\\n",
       "0                   0                       0   \n",
       "1                   0                       0   \n",
       "2                   0                       0   \n",
       "3                   0                       0   \n",
       "4                   0                       0   \n",
       "...               ...                     ...   \n",
       "455156              0                       0   \n",
       "455157              1                       0   \n",
       "455158              0                       0   \n",
       "455159              0                       0   \n",
       "455160              0                       0   \n",
       "\n",
       "        Pedestrian_Road_Maintenance_Worker  Casualty_Type  \\\n",
       "0                                        0              9   \n",
       "1                                        0              9   \n",
       "2                                        0              1   \n",
       "3                                        0              0   \n",
       "4                                        0              9   \n",
       "...                                    ...            ...   \n",
       "455156                                   0              0   \n",
       "455157                                   0             19   \n",
       "455158                                   0              4   \n",
       "455159                                   0              9   \n",
       "455160                                   0              9   \n",
       "\n",
       "        Casualty_Home_Area_Type  \n",
       "0                             1  \n",
       "1                             1  \n",
       "2                             1  \n",
       "3                             1  \n",
       "4                             1  \n",
       "...                         ...  \n",
       "455156                        3  \n",
       "455157                        1  \n",
       "455158                        1  \n",
       "455159                        3  \n",
       "455160                        2  \n",
       "\n",
       "[455161 rows x 15 columns]"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "References\n",
    "\n",
    "1. https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Time-Series Models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 84,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/devarakondasantosh/anaconda3/lib/python3.7/site-packages/IPython/core/interactiveshell.py:3063: DtypeWarning: Columns (0) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  interactivity=interactivity, compiler=compiler, result=result)\n"
     ]
    }
   ],
   "source": [
    "#Loading the preprocessed data for Casualities\n",
    "# We observe that the casualities data has timestamp in the accident_index. Using this, we want to do time series.\n",
    "\n",
    "df = pd.read_csv(\"../data/data.csv\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Accident_Index</th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Casualty_Severity</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "      <th>Casualty_IMD_Decile</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>2019010128300</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>58</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2019010152270</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>24</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2019010155191</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>21</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>2019010155192</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>1</td>\n",
       "      <td>68</td>\n",
       "      <td>10</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "      <td>4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>2019010155194</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>47</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>458843</th>\n",
       "      <td>2017984121217</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "      <td>2</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>9</td>\n",
       "      <td>6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>3</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>458844</th>\n",
       "      <td>2017984121717</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>22</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>19</td>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>458845</th>\n",
       "      <td>2017984122317</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>25</td>\n",
       "      <td>5</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>4</td>\n",
       "      <td>1</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>458846</th>\n",
       "      <td>2017984122617</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>49</td>\n",
       "      <td>8</td>\n",
       "      <td>3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>3</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>458847</th>\n",
       "      <td>2017984122617</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>50</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>9</td>\n",
       "      <td>2</td>\n",
       "      <td>-1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>458848 rows Ã— 16 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       Accident_Index  Vehicle_Reference  Casualty_Reference  Casualty_Class  \\\n",
       "0       2019010128300                  1                   1               1   \n",
       "1       2019010152270                  1                   1               1   \n",
       "2       2019010155191                  2                   1               2   \n",
       "3       2019010155192                  1                   1               3   \n",
       "4       2019010155194                  1                   1               1   \n",
       "...               ...                ...                 ...             ...   \n",
       "458843  2017984121217                  1                   1               3   \n",
       "458844  2017984121717                  1                   1               2   \n",
       "458845  2017984122317                  1                   1               1   \n",
       "458846  2017984122617                  1                   1               1   \n",
       "458847  2017984122617                  2                   2               1   \n",
       "\n",
       "        Sex_of_Casualty  Age_of_Casualty  Age_Band_of_Casualty  \\\n",
       "0                     1               58                     9   \n",
       "1                     2               24                     5   \n",
       "2                     2               21                     5   \n",
       "3                     1               68                    10   \n",
       "4                     2               47                     8   \n",
       "...                 ...              ...                   ...   \n",
       "458843                2               49                     8   \n",
       "458844                1               22                     5   \n",
       "458845                1               25                     5   \n",
       "458846                1               49                     8   \n",
       "458847                1               50                     8   \n",
       "\n",
       "        Casualty_Severity  Pedestrian_Location  Pedestrian_Movement  \\\n",
       "0                       3                    0                    0   \n",
       "1                       3                    0                    0   \n",
       "2                       3                    0                    0   \n",
       "3                       2                    5                    4   \n",
       "4                       3                    0                    0   \n",
       "...                   ...                  ...                  ...   \n",
       "458843                  3                    9                    6   \n",
       "458844                  3                    0                    0   \n",
       "458845                  3                    0                    0   \n",
       "458846                  3                    0                    0   \n",
       "458847                  2                    0                    0   \n",
       "\n",
       "        Car_Passenger  Bus_or_Coach_Passenger  \\\n",
       "0                   0                       0   \n",
       "1                   0                       0   \n",
       "2                   0                       0   \n",
       "3                   0                       0   \n",
       "4                   0                       0   \n",
       "...               ...                     ...   \n",
       "458843              0                       0   \n",
       "458844              1                       0   \n",
       "458845              0                       0   \n",
       "458846              0                       0   \n",
       "458847              0                       0   \n",
       "\n",
       "        Pedestrian_Road_Maintenance_Worker  Casualty_Type  \\\n",
       "0                                        0              9   \n",
       "1                                        0              9   \n",
       "2                                        0              1   \n",
       "3                                        0              0   \n",
       "4                                        0              9   \n",
       "...                                    ...            ...   \n",
       "458843                                   0              0   \n",
       "458844                                   0             19   \n",
       "458845                                   0              4   \n",
       "458846                                   0              9   \n",
       "458847                                   0              9   \n",
       "\n",
       "        Casualty_Home_Area_Type  Casualty_IMD_Decile  \n",
       "0                             1                    2  \n",
       "1                             1                    3  \n",
       "2                             1                    1  \n",
       "3                             1                    4  \n",
       "4                             1                    3  \n",
       "...                         ...                  ...  \n",
       "458843                        3                   -1  \n",
       "458844                        1                    2  \n",
       "458845                        1                   -1  \n",
       "458846                        3                   -1  \n",
       "458847                        2                   -1  \n",
       "\n",
       "[458848 rows x 16 columns]"
      ]
     },
     "execution_count": 85,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         2019010128300\n",
       "1         2019010152270\n",
       "2         2019010155191\n",
       "3         2019010155192\n",
       "4         2019010155194\n",
       "              ...      \n",
       "458843    2017984121217\n",
       "458844    2017984121717\n",
       "458845    2017984122317\n",
       "458846    2017984122617\n",
       "458847    2017984122617\n",
       "Name: Accident_Index, Length: 458848, dtype: object"
      ]
     },
     "execution_count": 86,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Accident_Index']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         2019010128300\n",
       "1         2019010152270\n",
       "2         2019010155191\n",
       "3         2019010155192\n",
       "4         2019010155194\n",
       "              ...      \n",
       "458843    2017984121217\n",
       "458844    2017984121717\n",
       "458845    2017984122317\n",
       "458846    2017984122617\n",
       "458847    2017984122617\n",
       "Name: Year, Length: 458848, dtype: object"
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Year'] = df['Accident_Index'].astype(str)\n",
    "\n",
    "df['Year']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0         2019\n",
       "1         2019\n",
       "2         2019\n",
       "3         2019\n",
       "4         2019\n",
       "          ... \n",
       "458843    2017\n",
       "458844    2017\n",
       "458845    2017\n",
       "458846    2017\n",
       "458847    2017\n",
       "Name: Year, Length: 458848, dtype: object"
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df['Year'] = df['Year'].str[0:4]\n",
    "\n",
    "df['Year']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Casualty_Severity</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "      <th>Casualty_IMD_Decile</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "      <td>458848.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>1.479895</td>\n",
       "      <td>1.392139</td>\n",
       "      <td>1.490801</td>\n",
       "      <td>1.405062</td>\n",
       "      <td>37.497051</td>\n",
       "      <td>6.450504</td>\n",
       "      <td>2.818203</td>\n",
       "      <td>0.750979</td>\n",
       "      <td>0.590952</td>\n",
       "      <td>0.242950</td>\n",
       "      <td>0.070322</td>\n",
       "      <td>0.063649</td>\n",
       "      <td>7.237013</td>\n",
       "      <td>1.258231</td>\n",
       "      <td>3.855508</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>1.601020</td>\n",
       "      <td>2.361797</td>\n",
       "      <td>0.727490</td>\n",
       "      <td>0.490905</td>\n",
       "      <td>19.069044</td>\n",
       "      <td>2.247572</td>\n",
       "      <td>0.413915</td>\n",
       "      <td>2.108936</td>\n",
       "      <td>1.906667</td>\n",
       "      <td>0.569136</td>\n",
       "      <td>0.503588</td>\n",
       "      <td>0.350247</td>\n",
       "      <td>8.166837</td>\n",
       "      <td>0.613258</td>\n",
       "      <td>3.446473</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>-1.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>-1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>23.000000</td>\n",
       "      <td>5.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>34.000000</td>\n",
       "      <td>6.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>4.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>2.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>50.000000</td>\n",
       "      <td>8.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>0.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>1.000000</td>\n",
       "      <td>7.000000</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>999.000000</td>\n",
       "      <td>991.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>102.000000</td>\n",
       "      <td>11.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>10.000000</td>\n",
       "      <td>9.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>4.000000</td>\n",
       "      <td>2.000000</td>\n",
       "      <td>98.000000</td>\n",
       "      <td>3.000000</td>\n",
       "      <td>10.000000</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       Vehicle_Reference  Casualty_Reference  Casualty_Class  Sex_of_Casualty  \\\n",
       "count      458848.000000       458848.000000   458848.000000    458848.000000   \n",
       "mean            1.479895            1.392139        1.490801         1.405062   \n",
       "std             1.601020            2.361797        0.727490         0.490905   \n",
       "min             1.000000            1.000000        1.000000         1.000000   \n",
       "25%             1.000000            1.000000        1.000000         1.000000   \n",
       "50%             1.000000            1.000000        1.000000         1.000000   \n",
       "75%             2.000000            1.000000        2.000000         2.000000   \n",
       "max           999.000000          991.000000        3.000000         2.000000   \n",
       "\n",
       "       Age_of_Casualty  Age_Band_of_Casualty  Casualty_Severity  \\\n",
       "count    458848.000000         458848.000000      458848.000000   \n",
       "mean         37.497051              6.450504           2.818203   \n",
       "std          19.069044              2.247572           0.413915   \n",
       "min           0.000000              1.000000           1.000000   \n",
       "25%          23.000000              5.000000           3.000000   \n",
       "50%          34.000000              6.000000           3.000000   \n",
       "75%          50.000000              8.000000           3.000000   \n",
       "max         102.000000             11.000000           3.000000   \n",
       "\n",
       "       Pedestrian_Location  Pedestrian_Movement  Car_Passenger  \\\n",
       "count        458848.000000        458848.000000  458848.000000   \n",
       "mean              0.750979             0.590952       0.242950   \n",
       "std               2.108936             1.906667       0.569136   \n",
       "min               0.000000             0.000000      -1.000000   \n",
       "25%               0.000000             0.000000       0.000000   \n",
       "50%               0.000000             0.000000       0.000000   \n",
       "75%               0.000000             0.000000       0.000000   \n",
       "max              10.000000             9.000000       2.000000   \n",
       "\n",
       "       Bus_or_Coach_Passenger  Pedestrian_Road_Maintenance_Worker  \\\n",
       "count           458848.000000                       458848.000000   \n",
       "mean                 0.070322                            0.063649   \n",
       "std                  0.503588                            0.350247   \n",
       "min                  0.000000                            0.000000   \n",
       "25%                  0.000000                            0.000000   \n",
       "50%                  0.000000                            0.000000   \n",
       "75%                  0.000000                            0.000000   \n",
       "max                  4.000000                            2.000000   \n",
       "\n",
       "       Casualty_Type  Casualty_Home_Area_Type  Casualty_IMD_Decile  \n",
       "count  458848.000000            458848.000000        458848.000000  \n",
       "mean        7.237013                 1.258231             3.855508  \n",
       "std         8.166837                 0.613258             3.446473  \n",
       "min         0.000000                 1.000000            -1.000000  \n",
       "25%         2.000000                 1.000000             1.000000  \n",
       "50%         9.000000                 1.000000             4.000000  \n",
       "75%         9.000000                 1.000000             7.000000  \n",
       "max        98.000000                 3.000000            10.000000  "
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Accident_Index</th>\n",
       "      <th>Vehicle_Reference</th>\n",
       "      <th>Casualty_Reference</th>\n",
       "      <th>Casualty_Class</th>\n",
       "      <th>Sex_of_Casualty</th>\n",
       "      <th>Age_of_Casualty</th>\n",
       "      <th>Age_Band_of_Casualty</th>\n",
       "      <th>Casualty_Severity</th>\n",
       "      <th>Pedestrian_Location</th>\n",
       "      <th>Pedestrian_Movement</th>\n",
       "      <th>Car_Passenger</th>\n",
       "      <th>Bus_or_Coach_Passenger</th>\n",
       "      <th>Pedestrian_Road_Maintenance_Worker</th>\n",
       "      <th>Casualty_Type</th>\n",
       "      <th>Casualty_Home_Area_Type</th>\n",
       "      <th>Casualty_IMD_Decile</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Year</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2017</th>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "      <td>162341</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2018</th>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "      <td>151955</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2019</th>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "      <td>144552</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "      Accident_Index  Vehicle_Reference  Casualty_Reference  Casualty_Class  \\\n",
       "Year                                                                          \n",
       "2017          162341             162341              162341          162341   \n",
       "2018          151955             151955              151955          151955   \n",
       "2019          144552             144552              144552          144552   \n",
       "\n",
       "      Sex_of_Casualty  Age_of_Casualty  Age_Band_of_Casualty  \\\n",
       "Year                                                           \n",
       "2017           162341           162341                162341   \n",
       "2018           151955           151955                151955   \n",
       "2019           144552           144552                144552   \n",
       "\n",
       "      Casualty_Severity  Pedestrian_Location  Pedestrian_Movement  \\\n",
       "Year                                                                \n",
       "2017             162341               162341               162341   \n",
       "2018             151955               151955               151955   \n",
       "2019             144552               144552               144552   \n",
       "\n",
       "      Car_Passenger  Bus_or_Coach_Passenger  \\\n",
       "Year                                          \n",
       "2017         162341                  162341   \n",
       "2018         151955                  151955   \n",
       "2019         144552                  144552   \n",
       "\n",
       "      Pedestrian_Road_Maintenance_Worker  Casualty_Type  \\\n",
       "Year                                                      \n",
       "2017                              162341         162341   \n",
       "2018                              151955         151955   \n",
       "2019                              144552         144552   \n",
       "\n",
       "      Casualty_Home_Area_Type  Casualty_IMD_Decile  \n",
       "Year                                                \n",
       "2017                   162341               162341  \n",
       "2018                   151955               151955  \n",
       "2019                   144552               144552  "
      ]
     },
     "execution_count": 90,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.groupby('Year').count()\n",
    "\n",
    "#We could observe that the number of accidents in 2019 was the lowest of all the data that we have.\n",
    "\n",
    "# 2019 - 144552\n",
    "\n",
    "# 2018 - 151955\n",
    "\n",
    "# 2017 - 162341"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# x axis values \n",
    "x = [2017,2018,2019] \n",
    "# corresponding y axis values \n",
    "y = [162341,151955,144552] \n",
    "  \n",
    "# plotting the points  \n",
    "plt.plot(x, y) \n",
    "  \n",
    "# naming the x axis \n",
    "plt.xlabel('Year') \n",
    "# naming the y axis \n",
    "plt.ylabel('Number of Accidents That Happened') \n",
    "  \n",
    "# giving a title to my graph \n",
    "plt.title('Accidents in a Year') \n",
    "  \n",
    "# function to show the plot \n",
    "plt.show() "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Classification Model for the Vehicles Database"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The classification algorithms were referenced from : https://machinelearningmastery.com/machine-learning-algorithms-mini-course/"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.linear_model import LogisticRegression\n",
    "log_class_model = LogisticRegression(random_state=0, multi_class='ovr')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.head(20)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Reading the dataset for the casualty information\n",
    "df_cas = pd.read_csv(\"../data/Road_Safety_Data_Casualties_2019.csv\",low_memory=False)\n",
    "df_cas.head(20) #confirm correct data is imported"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "#checking the size of casualty database\n",
    "df_cas.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We only need the casuatly seversity information from the casualty database. Dropping all other columns."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_cas.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_cas.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_cas.Accident_Index.nunique()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***Merging the casulty serverity information to vehicle database***"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge=pd.merge(df,df_cas)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge.isnull().sum().sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge['Casualty_Severity'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge['Casualty_Severity'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge['Casualty_Severity'].value_counts(normalize=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge['Casualty_Severity'].value_counts().plot.bar()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***As seen from the information above this dataset is unbalanced. The sample size for Casualty serverity of '1' is very low, only around 1%. Taking the dataset as is will not yeild good prediction.***"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Splitting the data into train and test mode\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.preprocessing import StandardScaler"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge.select_dtypes(include=[np.number]).columns.values"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Providing a split of 70:30 for train/test purpose\n",
    "\n",
    "predictor_cols = ['Vehicle_Type',\n",
    "'Towing_and_Articulation',\n",
    "'Vehicle_Manoeuvre',\n",
    "'Vehicle_Location-Restricted_Lane',\n",
    "'Junction_Location',\n",
    "'Skidding_and_Overturning',\n",
    "'Hit_Object_in_Carriageway',\n",
    "'Vehicle_Leaving_Carriageway',\n",
    "'Hit_Object_off_Carriageway',\n",
    "'1st_Point_of_Impact',\n",
    "'Was_Vehicle_Left_Hand_Drive?',\n",
    "'Sex_of_Driver',\n",
    "'Age_Band_of_Driver',\n",
    "'Engine_Capacity_(CC)',\n",
    "'Propulsion_Code',\n",
    "'Age_of_Vehicle']\n",
    "X_train, X_test, y_train, y_test = train_test_split(df_merge[predictor_cols],df_merge.Casualty_Severity, test_size=0.3)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "log_class_model.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***Measuring the accuracy of the model.***"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_logistic = log_class_model.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_logistic"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We got an accuracy of 81.94 percent with this model and the unbalanced dataset. We will try to resize the database to balance it. We will apply the logistic regression model again after that."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***Confusion Matrix to analyze the performance:***"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_predicted = log_class_model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.metrics import confusion_matrix\n",
    "confusion_matrix(y_test, y_predicted)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_predicted2 = log_class_model.predict(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "confusion_matrix(y_train, y_predicted2)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Scaled dataset"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "***Scaling of dataset was suggested in error due to inability to process the dataset***"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import preprocessing\n",
    "X_SCALED = preprocessing.scale(X_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "log_class_model.fit(X_SCALED, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_logistic_scaled = log_class_model.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_logistic_scaled"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Scaling results in huge drop in accuracy"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_predicted = log_class_model.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "confusion_matrix(y_test, y_predicted)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Adding more classifiers\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sklearn\n",
    "from sklearn import ensemble"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.ensemble import AdaBoostClassifier"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# AdaBoost Default Classifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ada_class_model_def = AdaBoostClassifier()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ada_class_model_def.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_ada_boost = ada_class_model_def.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_ada_boost"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_predicted = ada_class_model_def.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "confusion_matrix(y_test, y_predicted)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Adaboost Custom settings Classifier"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Reference: https://towardsdatascience.com/machine-learning-part-17-boosting-algorithms-adaboost-in-python-d00faac6c464"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ada_class_model_cus = AdaBoostClassifier(n_estimators=200, learning_rate = .5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "ada_class_model_cus.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_ada_boost_cus = ada_class_model_cus.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_ada_boost_cus"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "y_predicted = ada_class_model_cus.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "confusion_matrix(y_test, y_predicted)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# RandomForestClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "rand_class_model_def = RandomForestClassifier()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "rand_class_model_def.fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_rand_class = rand_class_model_def.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "score_rand_class"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Comparing different models"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "x_axis = ['Logistic', 'Logistic_scaled', 'AdaBoost', 'AdaBoost_custom', 'RandomForest']\n",
    "y_axis = [score_logistic, score_logistic_scaled, score_ada_boost, score_ada_boost_cus, score_rand_class]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "plt.bar(x_axis, y_axis)\n",
    "plt.xlabel(\"Different classification models\") \n",
    "plt.ylabel(\"Accuracy of each model\")\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**As seen above Scaling of data gives worst results with Logistic regression classifier. All other classification models give nearly similar results with logisctic regression providing best results**\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
